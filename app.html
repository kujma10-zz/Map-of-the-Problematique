<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />

		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

		<title>app</title>
		<meta name="description" content="" />
		<meta name="author" content="user" />

		<!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
	</head>

	<body>
		<canvas id="myCanvas" width="1000" height="800" >
			Canvas not supported
		</canvas>
		<script src="http://code.jquery.com/jquery.min.js"></script>
		<script>
			var data;
			$.getJSON("regions.json", function(d) {
				console.log(d);
				data = d;
				// data is a JavaScript object now. Handle it as such
			});

			// constants
			var IMAGE_WIDTH = 1000;
			var IMAGE_HEIGHT = 800;
			var DISTANCE_X = 0;
			var DISTANCE_Y = 0;

			// add image on canvas
			var canvas = document.getElementById('myCanvas');
			var context = canvas.getContext('2d');
			var imageObj = new Image();
			imageObj.onload = function() {
				context.drawImage(imageObj, DISTANCE_X, DISTANCE_Y, IMAGE_WIDTH, IMAGE_HEIGHT);
			};
			imageObj.src = '/Map-of-the-Problematique/pics/Caucasus_290_BC_map_de_alt.png';

			// add click event on canvas and get coordinates
			canvas.addEventListener("click", function() {
				var x = event.pageX - DISTANCE_X - 8;
				var y = event.pageY - DISTANCE_Y - 8;
				console.log(x);
				console.log(y);
				console.log(data[0].info.regions[0].name)
				getRegion(x, y);
			});

			function getRegion(x, t) {
				var twoDArr = data[0].info.regions;
				for (var i = 0; i < twoDArr.length; i++) {
					var arr = twoDArr[i].coordinates;
					var regionName = twoDArr[i].name;
					for (var j = 0; j < arr.length; j += 4) {
						var cx = arr[j];
						var cy = arr[j + 1];
						var dx = arr[j + 2];
						var dy = arr[j + 3];

						var a = new Object();

						var counter = 0;
						// if (intersect(x, y, xi, yi) == true) {
							// counter++;
						// }
					};
				}
			}

			/*
			 * var pt = new Object();
			 * encapsulates x and y: pt.x; pt.y.
			 */

			function area(a, b, c) {// pts
				return (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x);
			}

			function intersect_1(a, b, c, d) {// ints
				if (a > b)
					swap(a, b);
				if (c > d)
					swap(c, d);
				return Math.max(a, c) <= Math.min(b, d);
			}

			function intersect(a, b, c, d) {// pts
				return intersect_1(a.x, b.x, c.x, d.x) && intersect_1(a.y, b.y, c.y, d.y) && (area(a, b, c) * area(a, b, d) <= 0) && (area(c, d, a) * area(c, d, b) <= 0);
			}

			function swap(a, b) {// ints
				var tmp = a;
				a = b;
				b = tmp;
			}
		</script>
	</body>
</html>
